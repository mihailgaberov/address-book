var abApp=angular.module("address-book",["LocalStorageModule","ngRoute"]);abApp.config(["localStorageServiceProvider","$routeProvider",function(t,e){t.setPrefix("address-book"),e.when("/",{templateUrl:"views/results/results.html",controller:"ResultsController",resolve:{resolveData:["ResultEntryFactory",function(t){return t.getAllEntries()}]}}).otherwise({redirectTo:"/"})}]).constant("_",window._).run(["CountryListFactory",function(t){var e=require("country-list")();t.setCountryList(e)}]),angular.module("address-book").factory("CountryListFactory",[function(){"use strict";var t={},e=function(e){t=e},r=function(){return t.getData()},o=function(e){return t.getName(e)},n=function(e){return t.getCode(e)};return{getCountryList:r,setCountryList:e,getNameByCode:o,getCodeByName:n}}]),angular.module("address-book").constant("Events",{ADD:"addNewEntry",REMOVE:"removeEntry",UPDATE:"updateEntry"}),angular.module("address-book").factory("ResultEntryFactory",["localStorageService","$q","$rootScope",function(t,e,r){"use strict";var o=t.get("index"),n=function(e){t.isSupported&&(o||t.set("index",o=1),e.id=o,t.set("entry:"+o,e),t.set("index",++o)),r.$broadcast(Events.ADD,e)},a=function(e,o){if(confirm("Are you sure?")){var n="entry:"+e;t.remove(n),r.$broadcast(Events.REMOVE,o)}},s=function(t,e){r.$broadcast(Events.UPDATE,{firstName:"Gosho",lastName:"Gaddev",email:"biocniam@abvfd.com",country:"Bulgaria"}),console.log(">>> edit entryId: ",t)},i=function(){var r=t.length();if(r-1){var o,n=[],a=t.keys();for(o=0;o<a.length;o++)/entry.\d+/.test(a[o])&&n.push(t.get(a[o]))}return e.when(n)};return{addEntry:n,getAllEntries:i,editEntry:s,deleteEntry:a}}]),angular.module("address-book").controller("FormController",["$scope","CountryListFactory","ResultEntryFactory",function(t,e,r){this.countriesData=e.getCountryList(),this.submitForm=function(){var o={firstName:t.firstName,lastName:t.lastName,email:t.email,country:e.getNameByCode(t.country)};0===t.recordId.value?r.addEntry(o):console.log(">>>>> update entry")},t.$on(Events.UPDATE,function(r,o){t.firstName=o.firstName,t.lastName=o.lastName,t.email=o.email,t.country=e.getCodeByName(o.country)})}]).directive("addressBookForm",function(){return{controller:"FormController",controllerAs:"fc",restrict:"E",scope:{},templateUrl:"views/form/address-book-form.html",link:function(t,e,r,o){t.countries=o.countriesData}}}),angular.module("address-book").controller("ResultsController",["ResultEntryFactory","resolveData","$scope",function(t,e,r){_.isUndefined(e)?r.entries=[]:r.entries=e,r.$on("addNewEntry",function(t,e){r.entries.push(e)}),r.$on("removeEntry",function(t,e){r.entries.splice(e,1)}),r.editEntry=function(e,r){t.editEntry(e,r)},r.deleteEntry=function(e,r){t.deleteEntry(e,r)}}]);