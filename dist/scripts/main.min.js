var abApp=angular.module("address-book",["LocalStorageModule","ngRoute"]);abApp.config(["localStorageServiceProvider","$routeProvider",function(t,e){t.setPrefix("address-book"),e.when("/",{templateUrl:"views/results/results.html",controller:"ResultsController",resolve:{resolveData:["ResultEntryFactory",function(t){return t.getAllEntries()}]}}).otherwise({redirectTo:"/"})}]).constant("_",window._).run(["CountryListFactory",function(t){var e=require("country-list")();t.setCountryList(e)}]),angular.module("address-book").factory("CountryListFactory",[function(){"use strict";var t={},e=function(e){t=e},r=function(){return t.getData()},n=function(e){return t.getName(e)},o=function(e){return t.getCode(e)};return{getCountryList:r,setCountryList:e,getNameByCode:n,getCodeByName:o}}]),angular.module("address-book").constant("Events",{ADD:"addNewEntry",REMOVE:"removeEntry",EDIT:"editEntry",UPDATE:"updateEntry"}),angular.module("address-book").factory("ResultEntryFactory",["localStorageService","$q","$rootScope","Events",function(t,e,r,n){"use strict";var o=t.get("index"),a=function(t){return"entry:"+t},s=function(e){t.isSupported&&(o||t.set("index",o=1),e.id=o,t.set("entry:"+o,e),t.set("index",++o)),r.$broadcast(n.ADD,e)},i=function(e,o){confirm("Are you sure?")&&(t.remove(a(e)),r.$broadcast(n.REMOVE,o))},u=function(e,o){var s=t.get(a(e));r.$broadcast(n.EDIT,s)},c=function(e,o){o.id=e,t.set(a(e),o);var s=l();r.$broadcast(n.UPDATE,s)},l=function(){var r=t.length();if(r-1){var n,o=[],a=t.keys();for(n=0;n<a.length;n++)/entry.\d+/.test(a[n])&&o.push(t.get(a[n]))}return e.when(o)};return{addEntry:s,getAllEntries:l,editEntry:u,updateEntry:c,deleteEntry:i}}]),angular.module("address-book").controller("ResultsController",["ResultEntryFactory","resolveData","$scope","Events",function(t,e,r,n){_.isUndefined(e)?r.entries=[]:r.entries=e,r.$on(n.ADD,function(t,e){r.entries.push(e)}),r.$on(n.UPDATE,function(t,e){e.then(function(t){r.entries=t})}),r.$on(n.REMOVE,function(t,e){r.entries.splice(e,1)}),r.editEntry=function(e,r){t.editEntry(e,r)},r.deleteEntry=function(e,r){t.deleteEntry(e,r)}}]),angular.module("address-book").controller("FormController",["$scope","CountryListFactory","ResultEntryFactory","Events",function(t,e,r,n){this.countriesData=e.getCountryList(),this.submitForm=function(){var n={firstName:t.firstName,lastName:t.lastName,email:t.email,country:e.getNameByCode(t.country)};0===t.recordId.value?r.addEntry(n):r.updateEntry(t.recordId.value,n),t.recordId.value=0,t.resetForm()},t.resetForm=function(){t.firstName="",t.lastName="",t.email="",t.country=""},t.$on(n.EDIT,function(r,n){t.firstName=n.firstName,t.lastName=n.lastName,t.email=n.email,t.country=e.getCodeByName(n.country),t.recordId.value=n.id})}]).directive("addressBookForm",function(){return{controller:"FormController",controllerAs:"fc",restrict:"E",scope:{},templateUrl:"views/form/address-book-form.html",link:function(t,e,r,n){t.countries=n.countriesData}}});